import{c as Ct,g as Nt,r as It,u as Ot,i as qt}from"./proxy-config-OqE8FvQS.js";const At=["n/a","not available","-","none","0000000000",""];function wt(r){const i=r.toLowerCase().trim().replace(/,+$/,"");return At.includes(i)}const Lt={itemNumber:["UPC","Item #","ASIN","SKU","Product ID","Item Number","Barcode","EAN","Model"],productName:["Item Description","Product Name","Description","Title","Name","Product"],qty:["Qty","Quantity","Units","Count"],unitRetail:["Unit Retail","Retail Price","MSRP","Price","Retail","Unit Price"]},Tt=new Map([["ace",{itemNumber:["UPC"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["amz",{itemNumber:["ASIN"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["amzd",{itemNumber:["ASIN"],productName:["Item Title","Model","Brand"],qty:["Qty"],unitRetail:["Lot item price"]}],["att",{itemNumber:["UPC"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["by",{itemNumber:["UPC"],productName:["Item Description"],qty:["Quantity"],unitRetail:["Unit Retail"]}],["costco",{itemNumber:["Item #"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["jcp",{itemNumber:["Item #","Brand"],productName:["Brand","Subcategory"],qty:["Qty"],unitRetail:["Unit Retail"]}],["qvc",{itemNumber:["Item #"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["rc",{itemNumber:["Item #","UPC"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["tgt",{itemNumber:["UPC","Item #"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}],["tl",{itemNumber:["UPC"],productName:["Product Name"],qty:["Quantity","Qty"],unitRetail:["Orig. Retail","Unit Retail"]}],["bstock",{itemNumber:["Item #"],productName:["Item Description"],qty:["Qty"],unitRetail:["Unit Retail"]}]]);function Dt(r){return Tt.get(r.toLowerCase())??Lt}function Ft(){return{upc:["upc","upc code","upc_code","item #","item number","item_number","item no","item no.","sku","sku #","sku_number","product code","product_code","asin","model","model #","model number","model_number","part #","part number","part_number","barcode","ean","lot item #","lot_item_number","manifest item #","manifest_item_number"],productName:["product name","product_name","item name","item_name","name","title","description","item description","item_description","product description","product_description","product title","product_title","lot description","lot_description","manifest description","manifest_description","item","product"],unitRetail:["unit retail","unit_retail","retail","retail price","retail_price","msrp","list price","list_price","unit price","unit_price","price","price each","price_each","original price","original_price","orig retail","orig_retail","retail value","retail_value","est retail","est_retail","estimated retail","estimated_retail"],quantity:["quantity","qty","units","count","unit count","unit_count","item count","item_count","items","total units","total_units","total qty","total_qty","pallet qty","pallet_qty","lot qty","lot_qty","manifest qty","manifest_qty","available qty","available_qty"]}}function Pt(){return{upc:["upc","upc code","upc_code","item #","item number","item_number","item no","sku","sku #","product code","product_code","model","model #","model number","model_number","part #","part number","part_number","barcode","ean","asin","tech item #","tech_item_number","inventory id","inventory_id","product id","product_id"],productName:["product name","product_name","item name","item_name","name","title","description","item description","item_description","product description","product_description","tech description","tech_description","product title","product_title","full description","full_description","item","product"],unitRetail:["unit retail","unit_retail","retail","retail price","retail_price","msrp","list price","list_price","unit price","unit_price","price","price each","original price","original_price","orig price","retail value","retail_value","market price","market_price","suggested retail","suggested_retail"],quantity:["quantity","qty","units","count","unit count","unit_count","item count","item_count","items","total units","total_units","total qty","total_qty","available","available qty","available_qty","in stock","in_stock","stock qty","stock_qty"]}}const Ut=/^B0[A-Z0-9]{8}$/,Mt=4.5;function zt(r){for(const i of r){if(i==null)continue;const a=String(i);if(Ut.test(a))return a}return""}function _t(r,i){if(i<=0||r.length===0)return;const a=r.length-i;if(!(a<0))return r[a]}function jt(r){if(isNaN(r)||r<0||r===0)return 0;const i=r*Mt;return Number(i.toFixed(2))}function Bt(r,i){return r.length>i.length}function gt(r){if(r==null)return 0;if(typeof r=="number")return isNaN(r)?0:r;const i=String(r).replace(/[$,]/g,""),a=parseFloat(i);return isNaN(a)?0:a}function yt(r){if(r==null)return 1;if(typeof r=="number")return isNaN(r)||r<1?1:Math.round(r);const i=parseInt(String(r),10);return isNaN(i)||i<1?1:i}function Qt(r,i,a){if(i.length===0)return null;const s=zt(i);let f="",_=1,v=0;if(Bt(i,a)){const l=_t(i,3),U=_t(i,2);_=yt(l),v=gt(U),f=""}else f=String(r["Item Title"]??r.Model??r.Brand??"").trim(),_=yt(r.Qty),v=gt(r["Lot item price"]);const A=jt(v);return!s&&!f&&A===0?null:{asin:s,productName:f,qty:_,unitRetail:A}}function $t(){return{upc:["asin"],productName:["item title","model","brand"],unitRetail:["lot item price"],quantity:["qty"]}}function Wt(r){switch(r){case"bstock":return Ft();case"techliquidators":return Pt();case"amzd":return $t()}const i=Dt(r);return{upc:i.itemNumber.map(a=>a.toLowerCase()),productName:i.productName.map(a=>a.toLowerCase()),unitRetail:i.unitRetail.map(a=>a.toLowerCase()),quantity:i.qty.map(a=>a.toLowerCase())}}function Ht(r,i,a){if(r.length===0)return[];const s=Object.keys(r[0]),f=[],_=new Date().toISOString();for(const v of r){const R=Object.values(v),A=v.__parsed_extra||[],l=A.length>0?[...R.filter(Y=>Y!==A),...A]:R,U=Qt(v,l,s);U?f.push({upc:U.asin,productName:U.productName||"Unknown Product",quantity:U.qty,unitRetail:U.unitRetail,sourceSite:i,originalFilename:a,parsedDate:_}):l.length>0&&f.push({upc:"",productName:"Unknown Product",quantity:1,unitRetail:0,sourceSite:i,originalFilename:a,parsedDate:_})}return f}function Rt(r,i,a){if(!r||r.length===0)return[];if(i==="amzd")return Ht(r,i,a);const s=Wt(i),f=Object.keys(r[0]),_=Kt(f,s),v=[],R=new Date().toISOString();for(const A of r){const l=Vt(A,_,i,a,R);l&&Gt(l)&&v.push(l)}return v}function Kt(r,i){const a={upc:null,productName:null,unitRetail:null,quantity:null},s=r.map(f=>f.toLowerCase().trim());for(const[f,_]of Object.entries(i))for(const v of _){const R=s.findIndex(A=>A===v.toLowerCase()||A.includes(v.toLowerCase()));if(R!==-1){a[f]=r[R];break}}return a}function Vt(r,i,a,s,f){const _=bt(r,i.upc),v=bt(r,i.productName),R=kt(r,i.unitRetail),A=kt(r,i.quantity)||1;return!_&&!v?null:{upc:_||"",productName:v||"Unknown Product",unitRetail:R||0,quantity:Math.max(1,Math.round(A)),sourceSite:a,originalFilename:s,parsedDate:f}}function bt(r,i){if(!i||r[i]===void 0||r[i]===null)return"";const a=String(r[i]).trim();return wt(a)?"":a}function kt(r,i){if(!i||r[i]===void 0||r[i]===null)return 0;const a=r[i];if(typeof a=="number")return a;const s=String(a).trim();if(wt(s))return 0;const f=s.replace(/[$,]/g,""),_=parseFloat(f);return isNaN(_)?0:_}function Gt(r){const i=r.upc.length>0||r.productName.length>0,a=r.quantity>0;return i&&a}var Et={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(r,i){((a,s)=>{r.exports=s()})(Ct,function a(){var s=typeof self<"u"?self:typeof window<"u"?window:s!==void 0?s:{},f,_=!s.document&&!!s.postMessage,v=s.IS_PAPA_WORKER||!1,R={},A=0,l={};function U(t){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var n=ct(e);n.chunkSize=parseInt(n.chunkSize),e.step||e.chunk||(n.chunkSize=null),this._handle=new dt(n),(this._handle.streamer=this)._config=n}).call(this,t),this.parseChunk=function(e,n){var u=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<u){let g=this._config.newline;g||(o=this._config.quoteChar||'"',g=this._handle.guessLineEndings(e,o)),e=[...e.split(g).slice(u)].join(g)}this.isFirstChunk&&x(this._config.beforeFirstChunk)&&(o=this._config.beforeFirstChunk(e))!==void 0&&(e=o),this.isFirstChunk=!1,this._halted=!1;var u=this._partialLine+e,o=(this._partialLine="",this._handle.parse(u,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(e=o.meta.cursor,u=(this._finished||(this._partialLine=u.substring(e-this._baseIndex),this._baseIndex=e),o&&o.data&&(this._rowCount+=o.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),v)s.postMessage({results:o,workerId:l.WORKER_ID,finished:u});else if(x(this._config.chunk)&&!n){if(this._config.chunk(o,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=o=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(o.data),this._completeResults.errors=this._completeResults.errors.concat(o.errors),this._completeResults.meta=o.meta),this._completed||!u||!x(this._config.complete)||o&&o.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),u||o&&o.meta.paused||this._nextChunk(),o}this._halted=!0},this._sendError=function(e){x(this._config.error)?this._config.error(e):v&&this._config.error&&s.postMessage({workerId:l.WORKER_ID,error:e,finished:!1})}}function Y(t){var e;(t=t||{}).chunkSize||(t.chunkSize=l.RemoteChunkSize),U.call(this,t),this._nextChunk=_?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(n){this._input=n,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(e=new XMLHttpRequest,this._config.withCredentials&&(e.withCredentials=this._config.withCredentials),_||(e.onload=X(this._chunkLoaded,this),e.onerror=X(this._chunkError,this)),e.open(this._config.downloadRequestBody?"POST":"GET",this._input,!_),this._config.downloadRequestHeaders){var n,u=this._config.downloadRequestHeaders;for(n in u)e.setRequestHeader(n,u[n])}var o;this._config.chunkSize&&(o=this._start+this._config.chunkSize-1,e.setRequestHeader("Range","bytes="+this._start+"-"+o));try{e.send(this._config.downloadRequestBody)}catch(g){this._chunkError(g.message)}_&&e.status===0&&this._chunkError()}},this._chunkLoaded=function(){e.readyState===4&&(e.status<200||400<=e.status?this._chunkError():(this._start+=this._config.chunkSize||e.responseText.length,this._finished=!this._config.chunkSize||this._start>=(n=>(n=n.getResponseHeader("Content-Range"))!==null?parseInt(n.substring(n.lastIndexOf("/")+1)):-1)(e),this.parseChunk(e.responseText)))},this._chunkError=function(n){n=e.statusText||n,this._sendError(new Error(n))}}function at(t){(t=t||{}).chunkSize||(t.chunkSize=l.LocalChunkSize),U.call(this,t);var e,n,u=typeof FileReader<"u";this.stream=function(o){this._input=o,n=o.slice||o.webkitSlice||o.mozSlice,u?((e=new FileReader).onload=X(this._chunkLoaded,this),e.onerror=X(this._chunkError,this)):e=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var o=this._input,g=(this._config.chunkSize&&(g=Math.min(this._start+this._config.chunkSize,this._input.size),o=n.call(o,this._start,g)),e.readAsText(o,this._config.encoding));u||this._chunkLoaded({target:{result:g}})},this._chunkLoaded=function(o){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(o.target.result)},this._chunkError=function(){this._sendError(e.error)}}function rt(t){var e;U.call(this,t=t||{}),this.stream=function(n){return e=n,this._nextChunk()},this._nextChunk=function(){var n,u;if(!this._finished)return n=this._config.chunkSize,e=n?(u=e.substring(0,n),e.substring(n)):(u=e,""),this._finished=!e,this.parseChunk(u)}}function ot(t){U.call(this,t=t||{});var e=[],n=!0,u=!1;this.pause=function(){U.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){U.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(o){this._input=o,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){u&&e.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),e.length?this.parseChunk(e.shift()):n=!0},this._streamData=X(function(o){try{e.push(typeof o=="string"?o:o.toString(this._config.encoding)),n&&(n=!1,this._checkIsFinished(),this.parseChunk(e.shift()))}catch(g){this._streamError(g)}},this),this._streamError=X(function(o){this._streamCleanUp(),this._sendError(o)},this),this._streamEnd=X(function(){this._streamCleanUp(),u=!0,this._streamData("")},this),this._streamCleanUp=X(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function dt(t){var e,n,u,o,g=Math.pow(2,53),T=-g,Q=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,$=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,y=this,I=0,d=0,z=!1,p=!1,b=[],c={data:[],errors:[],meta:{}};function D(k){return t.skipEmptyLines==="greedy"?k.join("").trim()==="":k.length===1&&k[0].length===0}function L(){if(c&&u&&(W("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'"),u=!1),t.skipEmptyLines&&(c.data=c.data.filter(function(h){return!D(h)})),M()){let h=function(q,F){x(t.transformHeader)&&(q=t.transformHeader(q,F)),b.push(q)};if(c)if(Array.isArray(c.data[0])){for(var k=0;M()&&k<c.data.length;k++)c.data[k].forEach(h);c.data.splice(0,1)}else c.data.forEach(h)}function E(h,q){for(var F=t.header?{}:[],S=0;S<h.length;S++){var C=S,w=h[S],w=((H,m)=>(N=>(t.dynamicTypingFunction&&t.dynamicTyping[N]===void 0&&(t.dynamicTyping[N]=t.dynamicTypingFunction(N)),(t.dynamicTyping[N]||t.dynamicTyping)===!0))(H)?m==="true"||m==="TRUE"||m!=="false"&&m!=="FALSE"&&((N=>{if(Q.test(N)&&(N=parseFloat(N),T<N&&N<g))return 1})(m)?parseFloat(m):$.test(m)?new Date(m):m===""?null:m):m)(C=t.header?S>=b.length?"__parsed_extra":b[S]:C,w=t.transform?t.transform(w,C):w);C==="__parsed_extra"?(F[C]=F[C]||[],F[C].push(w)):F[C]=w}return t.header&&(S>b.length?W("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+S,d+q):S<b.length&&W("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+S,d+q)),F}var O;c&&(t.header||t.dynamicTyping||t.transform)&&(O=1,!c.data.length||Array.isArray(c.data[0])?(c.data=c.data.map(E),O=c.data.length):c.data=E(c.data,0),t.header&&c.meta&&(c.meta.fields=b),d+=O)}function M(){return t.header&&b.length===0}function W(k,E,O,h){k={type:k,code:E,message:O},h!==void 0&&(k.row=h),c.errors.push(k)}x(t.step)&&(o=t.step,t.step=function(k){c=k,M()?L():(L(),c.data.length!==0&&(I+=k.data.length,t.preview&&I>t.preview?n.abort():(c.data=c.data[0],o(c,y))))}),this.parse=function(k,E,O){var h=t.quoteChar||'"',h=(t.newline||(t.newline=this.guessLineEndings(k,h)),u=!1,t.delimiter?x(t.delimiter)&&(t.delimiter=t.delimiter(k),c.meta.delimiter=t.delimiter):((h=((q,F,S,C,w)=>{var H,m,N,Z;w=w||[",","	","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var tt=0;tt<w.length;tt++){for(var K,nt=w[tt],j=0,V=0,P=0,B=(N=void 0,new ut({comments:C,delimiter:nt,newline:F,preview:10}).parse(q)),J=0;J<B.data.length;J++)S&&D(B.data[J])?P++:(K=B.data[J].length,V+=K,N===void 0?N=K:0<K&&(j+=Math.abs(K-N),N=K));0<B.data.length&&(V/=B.data.length-P),(m===void 0||j<=m)&&(Z===void 0||Z<V)&&1.99<V&&(m=j,H=nt,Z=V)}return{successful:!!(t.delimiter=H),bestDelimiter:H}})(k,t.newline,t.skipEmptyLines,t.comments,t.delimitersToGuess)).successful?t.delimiter=h.bestDelimiter:(u=!0,t.delimiter=l.DefaultDelimiter),c.meta.delimiter=t.delimiter),ct(t));return t.preview&&t.header&&h.preview++,e=k,n=new ut(h),c=n.parse(e,E,O),L(),z?{meta:{paused:!0}}:c||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,n.abort(),e=x(t.chunk)?"":e.substring(n.getCharIndex())},this.resume=function(){y.streamer._halted?(z=!1,y.streamer.parseChunk(e,!0)):setTimeout(y.resume,3)},this.aborted=function(){return p},this.abort=function(){p=!0,n.abort(),c.meta.aborted=!0,x(t.complete)&&t.complete(c),e=""},this.guessLineEndings=function(q,h){q=q.substring(0,1048576);var h=new RegExp(it(h)+"([^]*?)"+it(h),"gm"),O=(q=q.replace(h,"")).split("\r"),h=q.split(`
`),q=1<h.length&&h[0].length<O[0].length;if(O.length===1||q)return`
`;for(var F=0,S=0;S<O.length;S++)O[S][0]===`
`&&F++;return F>=O.length/2?`\r
`:"\r"}}function it(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ut(t){var e=(t=t||{}).delimiter,n=t.newline,u=t.comments,o=t.step,g=t.preview,T=t.fastMode,Q=null,$=!1,y=t.quoteChar==null?'"':t.quoteChar,I=y;if(t.escapeChar!==void 0&&(I=t.escapeChar),(typeof e!="string"||-1<l.BAD_DELIMITERS.indexOf(e))&&(e=","),u===e)throw new Error("Comment character same as delimiter");u===!0?u="#":(typeof u!="string"||-1<l.BAD_DELIMITERS.indexOf(u))&&(u=!1),n!==`
`&&n!=="\r"&&n!==`\r
`&&(n=`
`);var d=0,z=!1;this.parse=function(p,b,c){if(typeof p!="string")throw new Error("Input must be a string");var D=p.length,L=e.length,M=n.length,W=u.length,k=x(o),E=[],O=[],h=[],q=d=0;if(!p)return j();if(T||T!==!1&&p.indexOf(y)===-1){for(var F=p.split(n),S=0;S<F.length;S++){if(h=F[S],d+=h.length,S!==F.length-1)d+=n.length;else if(c)return j();if(!u||h.substring(0,W)!==u){if(k){if(E=[],Z(h.split(e)),V(),z)return j()}else Z(h.split(e));if(g&&g<=S)return E=E.slice(0,g),j(!0)}}return j()}for(var C=p.indexOf(e,d),w=p.indexOf(n,d),H=new RegExp(it(I)+it(y),"g"),m=p.indexOf(y,d);;)if(p[d]===y)for(m=d,d++;;){if((m=p.indexOf(y,m+1))===-1)return c||O.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:E.length,index:d}),K();if(m===D-1)return K(p.substring(d,m).replace(H,y));if(y===I&&p[m+1]===I)m++;else if(y===I||m===0||p[m-1]!==I){C!==-1&&C<m+1&&(C=p.indexOf(e,m+1));var N=tt((w=w!==-1&&w<m+1?p.indexOf(n,m+1):w)===-1?C:Math.min(C,w));if(p.substr(m+1+N,L)===e){h.push(p.substring(d,m).replace(H,y)),p[d=m+1+N+L]!==y&&(m=p.indexOf(y,d)),C=p.indexOf(e,d),w=p.indexOf(n,d);break}if(N=tt(w),p.substring(m+1+N,m+1+N+M)===n){if(h.push(p.substring(d,m).replace(H,y)),nt(m+1+N+M),C=p.indexOf(e,d),m=p.indexOf(y,d),k&&(V(),z))return j();if(g&&E.length>=g)return j(!0);break}O.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:E.length,index:d}),m++}}else if(u&&h.length===0&&p.substring(d,d+W)===u){if(w===-1)return j();d=w+M,w=p.indexOf(n,d),C=p.indexOf(e,d)}else if(C!==-1&&(C<w||w===-1))h.push(p.substring(d,C)),d=C+L,C=p.indexOf(e,d);else{if(w===-1)break;if(h.push(p.substring(d,w)),nt(w+M),k&&(V(),z))return j();if(g&&E.length>=g)return j(!0)}return K();function Z(P){E.push(P),q=d}function tt(P){var B=0;return B=P!==-1&&(P=p.substring(m+1,P))&&P.trim()===""?P.length:B}function K(P){return c||(P===void 0&&(P=p.substring(d)),h.push(P),d=D,Z(h),k&&V()),j()}function nt(P){d=P,Z(h),h=[],w=p.indexOf(n,d)}function j(P){if(t.header&&!b&&E.length&&!$){var B=E[0],J=Object.create(null),lt=new Set(B);let pt=!1;for(let et=0;et<B.length;et++){let G=B[et];if(J[G=x(t.transformHeader)?t.transformHeader(G,et):G]){let st,mt=J[G];for(;st=G+"_"+mt,mt++,lt.has(st););lt.add(st),B[et]=st,J[G]++,pt=!0,(Q=Q===null?{}:Q)[st]=G}else J[G]=1,B[et]=G;lt.add(G)}pt&&console.warn("Duplicate headers found and renamed."),$=!0}return{data:E,errors:O,meta:{delimiter:e,linebreak:n,aborted:z,truncated:!!P,cursor:q+(b||0),renamedHeaders:Q}}}function V(){o(j()),E=[],O=[]}},this.abort=function(){z=!0},this.getCharIndex=function(){return d}}function xt(t){var e=t.data,n=R[e.workerId],u=!1;if(e.error)n.userError(e.error,e.file);else if(e.results&&e.results.data){var o={abort:function(){u=!0,ht(e.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:ft,resume:ft};if(x(n.userStep)){for(var g=0;g<e.results.data.length&&(n.userStep({data:e.results.data[g],errors:e.results.errors,meta:e.results.meta},o),!u);g++);delete e.results}else x(n.userChunk)&&(n.userChunk(e.results,o,e.file),delete e.results)}e.finished&&!u&&ht(e.workerId,e.results)}function ht(t,e){var n=R[t];x(n.userComplete)&&n.userComplete(e),n.terminate(),delete R[t]}function ft(){throw new Error("Not implemented.")}function ct(t){if(typeof t!="object"||t===null)return t;var e,n=Array.isArray(t)?[]:{};for(e in t)n[e]=ct(t[e]);return n}function X(t,e){return function(){t.apply(e,arguments)}}function x(t){return typeof t=="function"}return l.parse=function(t,e){var n=(e=e||{}).dynamicTyping||!1;if(x(n)&&(e.dynamicTypingFunction=n,n={}),e.dynamicTyping=n,e.transform=!!x(e.transform)&&e.transform,!e.worker||!l.WORKERS_SUPPORTED)return n=null,l.NODE_STREAM_INPUT,typeof t=="string"?(t=(u=>u.charCodeAt(0)!==65279?u:u.slice(1))(t),n=new(e.download?Y:rt)(e)):t.readable===!0&&x(t.read)&&x(t.on)?n=new ot(e):(s.File&&t instanceof File||t instanceof Object)&&(n=new at(e)),n.stream(t);(n=(()=>{var u;return!!l.WORKERS_SUPPORTED&&(u=(()=>{var o=s.URL||s.webkitURL||null,g=a.toString();return l.BLOB_URL||(l.BLOB_URL=o.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",g,")();"],{type:"text/javascript"})))})(),(u=new s.Worker(u)).onmessage=xt,u.id=A++,R[u.id]=u)})()).userStep=e.step,n.userChunk=e.chunk,n.userComplete=e.complete,n.userError=e.error,e.step=x(e.step),e.chunk=x(e.chunk),e.complete=x(e.complete),e.error=x(e.error),delete e.worker,n.postMessage({input:t,config:e,workerId:n.id})},l.unparse=function(t,e){var n=!1,u=!0,o=",",g=`\r
`,T='"',Q=T+T,$=!1,y=null,I=!1,d=((()=>{if(typeof e=="object"){if(typeof e.delimiter!="string"||l.BAD_DELIMITERS.filter(function(b){return e.delimiter.indexOf(b)!==-1}).length||(o=e.delimiter),typeof e.quotes!="boolean"&&typeof e.quotes!="function"&&!Array.isArray(e.quotes)||(n=e.quotes),typeof e.skipEmptyLines!="boolean"&&typeof e.skipEmptyLines!="string"||($=e.skipEmptyLines),typeof e.newline=="string"&&(g=e.newline),typeof e.quoteChar=="string"&&(T=e.quoteChar),typeof e.header=="boolean"&&(u=e.header),Array.isArray(e.columns)){if(e.columns.length===0)throw new Error("Option columns is empty");y=e.columns}e.escapeChar!==void 0&&(Q=e.escapeChar+T),e.escapeFormulae instanceof RegExp?I=e.escapeFormulae:typeof e.escapeFormulae=="boolean"&&e.escapeFormulae&&(I=/^[=+\-@\t\r].*$/)}})(),new RegExp(it(T),"g"));if(typeof t=="string"&&(t=JSON.parse(t)),Array.isArray(t)){if(!t.length||Array.isArray(t[0]))return z(null,t,$);if(typeof t[0]=="object")return z(y||Object.keys(t[0]),t,$)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),Array.isArray(t.data)&&(t.fields||(t.fields=t.meta&&t.meta.fields||y),t.fields||(t.fields=Array.isArray(t.data[0])?t.fields:typeof t.data[0]=="object"?Object.keys(t.data[0]):[]),Array.isArray(t.data[0])||typeof t.data[0]=="object"||(t.data=[t.data])),z(t.fields||[],t.data||[],$);throw new Error("Unable to serialize unrecognized input");function z(b,c,D){var L="",M=(typeof b=="string"&&(b=JSON.parse(b)),typeof c=="string"&&(c=JSON.parse(c)),Array.isArray(b)&&0<b.length),W=!Array.isArray(c[0]);if(M&&u){for(var k=0;k<b.length;k++)0<k&&(L+=o),L+=p(b[k],k);0<c.length&&(L+=g)}for(var E=0;E<c.length;E++){var O=(M?b:c[E]).length,h=!1,q=M?Object.keys(c[E]).length===0:c[E].length===0;if(D&&!M&&(h=D==="greedy"?c[E].join("").trim()==="":c[E].length===1&&c[E][0].length===0),D==="greedy"&&M){for(var F=[],S=0;S<O;S++){var C=W?b[S]:S;F.push(c[E][C])}h=F.join("").trim()===""}if(!h){for(var w=0;w<O;w++){0<w&&!q&&(L+=o);var H=M&&W?b[w]:w;L+=p(c[E][H],w)}E<c.length-1&&(!D||0<O&&!q)&&(L+=g)}}return L}function p(b,c){var D,L;return b==null?"":b.constructor===Date?JSON.stringify(b).slice(1,25):(L=!1,I&&typeof b=="string"&&I.test(b)&&(b="'"+b,L=!0),D=b.toString().replace(d,Q),(L=L||n===!0||typeof n=="function"&&n(b,c)||Array.isArray(n)&&n[c]||((M,W)=>{for(var k=0;k<W.length;k++)if(-1<M.indexOf(W[k]))return!0;return!1})(D,l.BAD_DELIMITERS)||-1<D.indexOf(o)||D.charAt(0)===" "||D.charAt(D.length-1)===" ")?T+D+T:D)}},l.RECORD_SEP="",l.UNIT_SEP="",l.BYTE_ORDER_MARK="\uFEFF",l.BAD_DELIMITERS=["\r",`
`,'"',l.BYTE_ORDER_MARK],l.WORKERS_SUPPORTED=!_&&!!s.Worker,l.NODE_STREAM_INPUT=1,l.LocalChunkSize=10485760,l.RemoteChunkSize=5242880,l.DefaultDelimiter=",",l.Parser=ut,l.ParserHandle=dt,l.NetworkStreamer=Y,l.FileStreamer=at,l.StringStreamer=rt,l.ReadableStreamStreamer=ot,s.jQuery&&((f=s.jQuery).fn.parse=function(t){var e=t.config||{},n=[];return this.each(function(g){if(!(f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&s.FileReader)||!this.files||this.files.length===0)return!0;for(var T=0;T<this.files.length;T++)n.push({file:this.files[T],inputElem:this,instanceConfig:f.extend({},e)})}),u(),this;function u(){if(n.length===0)x(t.complete)&&t.complete();else{var g,T,Q,$,y=n[0];if(x(t.before)){var I=t.before(y.file,y.inputElem);if(typeof I=="object"){if(I.action==="abort")return g="AbortError",T=y.file,Q=y.inputElem,$=I.reason,void(x(t.error)&&t.error({name:g},T,Q,$));if(I.action==="skip")return void o();typeof I.config=="object"&&(y.instanceConfig=f.extend(y.instanceConfig,I.config))}else if(I==="skip")return void o()}var d=y.instanceConfig.complete;y.instanceConfig.complete=function(z){x(d)&&d(z,y.file,y.inputElem),o()},l.parse(y.file,y.instanceConfig)}}function o(){n.splice(0,1),u()}}),v&&(s.onmessage=function(t){t=t.data,l.WORKER_ID===void 0&&t&&(l.WORKER_ID=t.workerId),typeof t.input=="string"?s.postMessage({workerId:l.WORKER_ID,results:l.parse(t.input,t.config),finished:!0}):(s.File&&t.input instanceof File||t.input instanceof Object)&&(t=l.parse(t.input,t.config))&&s.postMessage({workerId:l.WORKER_ID,results:t,finished:!0})}),(Y.prototype=Object.create(U.prototype)).constructor=Y,(at.prototype=Object.create(U.prototype)).constructor=at,(rt.prototype=Object.create(rt.prototype)).constructor=rt,(ot.prototype=Object.create(U.prototype)).constructor=ot,l})})(Et);var Jt=Et.exports;const Xt=Nt(Jt);async function vt(r){return new Promise((i,a)=>{Xt.parse(r,{header:!0,skipEmptyLines:!0,transformHeader:s=>s.trim(),transform:s=>s.trim(),complete:s=>{if(s.errors.length>0){const f=s.errors.filter(_=>_.type==="FieldMismatch"||_.code==="TooFewFields");if(f.length>0&&s.data.length===0){a(new Error(`CSV parse error: ${f[0].message}`));return}}i(s.data)},error:s=>{a(new Error(`CSV parse error: ${s.message}`))}})})}async function St(r){try{const i=It(r,{type:"array"}),a=i.SheetNames[0];if(!a)throw new Error("No sheets found in workbook");const s=i.Sheets[a];if(!s)throw new Error("Could not read worksheet");return Ot.sheet_to_json(s,{raw:!1,defval:""})}catch(i){throw new Error(`XLSX parse error: ${i instanceof Error?i.message:"Unknown error"}`)}}qt().catch(r=>{console.error("[ManifestParser:SW] Failed to initialize proxy:",r)});chrome.runtime.onMessage.addListener((r,i,a)=>(Zt(r).then(a).catch(s=>{a({type:"ERROR",error:s.message})}),!0));async function Zt(r){switch(r.type){case"DOWNLOAD_MANIFEST":return await Yt(r.payload);case"PARSE_FILE":return await te(r.payload);case"FETCH_PAGE_TITLES":return await ee(r.payload);default:return{type:"ERROR",error:`Unknown message type: ${r.type}`}}}async function Yt(r){console.log(`[ManifestParser:SW] Downloading manifest from: ${r.url}`);try{const i=await fetch(r.url,{credentials:"include",headers:{Accept:"text/csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,*/*"}});if(console.log(`[ManifestParser:SW] Response status: ${i.status}`),!i.ok)throw new Error(`Failed to download: ${i.status} ${i.statusText}`);const a=await i.arrayBuffer(),s=ie(r.url),f=i.headers.get("content-type")||"",_=se(f,r.url,a);let v;if(_==="csv"){const A=new TextDecoder().decode(a);v=await vt(A)}else v=await St(a);const R=Rt(v,s,r.filename);return console.log(`[ManifestParser:SW] Parsed ${R.length} items from ${r.filename}`),{type:"PARSE_COMPLETE",payload:R}}catch(i){throw console.error("[ManifestParser:SW] Download failed:",i),new Error(`Download failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async function te(r){try{const i=atob(r.data),a=new Uint8Array(i.length);for(let R=0;R<i.length;R++)a[R]=i.charCodeAt(R);const s=a.buffer,f=ne(r.filename);let _;if(r.type==="csv"){const R=new TextDecoder().decode(s);_=await vt(R)}else _=await St(s);return{type:"PARSE_COMPLETE",payload:Rt(_,f,r.filename)}}catch(i){throw new Error(`Parse failed: ${i instanceof Error?i.message:"Unknown error"}`)}}async function ee(r){const i={};for(let s=0;s<r.urls.length;s+=5){const _=r.urls.slice(s,s+5).map(async R=>{const A=await re(R);return{url:R,retailer:A}});(await Promise.all(_)).forEach(({url:R,retailer:A})=>{i[R]=A})}return{type:"PAGE_TITLES_RESULT",payload:i}}async function re(r){try{const i=await fetch(r,{credentials:"include",headers:{Accept:"text/html"}});if(!i.ok)return"B-Stock";const s=(await i.text()).match(/<title[^>]*>([^<]+)<\/title>/i);if(s){const _=s[1].split("|");if(_.length>=2){const R=_[_.length-1].trim().replace(/\s*Liquidation\s*$/i,"").replace(/\s*Auctions?\s*$/i,"").replace(/\s*\d{4}-\d{2}-\d{2}\s*$/i,"").trim();if(R.length>0&&R.length<50)return R}}return"B-Stock"}catch{return"B-Stock"}}function ie(r){const i=r.toLowerCase();if(i.includes("bstock")||i.includes("b-stock"))return"bstock";if(i.includes("techliquidator"))return"techliquidators";if(i.includes("liquidation"))return"liquidation";try{return new URL(r).hostname.replace("www.","").split(".")[0]}catch{return"unknown"}}function ne(r){const i=r.toLowerCase();return i.includes("bstock")||i.includes("b-stock")?"bstock":i.includes("techliquidator")||i.includes("tech")?"techliquidators":"manual"}function se(r,i,a){if(r.includes("csv")||r.includes("text/plain"))return"csv";if(r.includes("spreadsheetml")||r.includes("xlsx"))return"xlsx";if(r.includes("ms-excel")||r.includes("xls"))return"xls";const s=i.toLowerCase();if(s.includes(".xlsx"))return"xlsx";if(s.includes(".xls"))return"xls";if(s.includes(".csv"))return"csv";const f=new Uint8Array(a.slice(0,4));return f[0]===80&&f[1]===75?"xlsx":f[0]===208&&f[1]===207&&f[2]===17&&f[3]===224?"xls":"csv"}
